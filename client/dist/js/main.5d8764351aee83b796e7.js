/*! For license information please see main.5d8764351aee83b796e7.js.LICENSE.txt */
(()=>{function e(e,n){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,n){if(e){if("string"==typeof e)return t(e,n);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){a&&(e=a);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,c=!0,i=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return c=e.done,e},e:function(e){i=!0,s=e},f:function(){try{c||null==a.return||a.return()}finally{if(i)throw s}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function n(){var e,t,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",s=r.toStringTag||"@@toStringTag";function c(n,r,o,s){var c=r&&r.prototype instanceof d?r:d,u=Object.create(c.prototype);return a(u,"_invoke",function(n,a,r){var o,s,c,d=0,u=r||[],l=!1,p={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return o=t,s=0,c=e,p.n=n,i}};function m(n,a){for(s=n,c=a,t=0;!l&&d&&!r&&t<u.length;t++){var r,o=u[t],m=p.p,f=o[2];n>3?(r=f===a)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=m&&((r=n<2&&m<o[1])?(s=0,p.v=a,p.n=o[1]):m<f&&(r=n<3||o[0]>a||a>f)&&(o[4]=n,o[5]=a,p.n=f,s=0))}if(r||n>1)return i;throw l=!0,a}return function(r,u,f){if(d>1)throw TypeError("Generator is already running");for(l&&1===u&&m(u,f),s=u,c=f;(t=s<2?e:c)||!l;){o||(s?s<3?(s>1&&(p.n=-1),m(s,c)):p.n=c:p.v=c);try{if(d=2,o){if(s||(r="next"),t=o[r]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),s=1);o=e}else if((t=(l=p.n<0)?c:n.call(a,p))!==i)break}catch(t){o=e,s=1,c=t}finally{d=1}}return{value:t,done:l}}}(n,o,s),!0),u}var i={};function d(){}function u(){}function l(){}t=Object.getPrototypeOf;var p=[][o]?t(t([][o]())):(a(t={},o,(function(){return this})),t),m=l.prototype=d.prototype=Object.create(p);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,a(e,s,"GeneratorFunction")),e.prototype=Object.create(m),e}return u.prototype=l,a(m,"constructor",l),a(l,"constructor",u),u.displayName="GeneratorFunction",a(l,s,"GeneratorFunction"),a(m),a(m,s,"Generator"),a(m,o,(function(){return this})),a(m,"toString",(function(){return"[object Generator]"})),(n=function(){return{w:c,m:f}})()}function a(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}a=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var s=function(t,n){a(e,t,(function(e){return this._invoke(t,n,e)}))};s("next",0),s("throw",1),s("return",2)}},a(e,t,n,r)}function r(e,t,n,a,r,o,s){try{var c=e[o](s),i=c.value}catch(e){return void n(e)}c.done?t(i):Promise.resolve(i).then(a,r)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(a,o){var s=e.apply(t,n);function c(e){r(s,a,o,c,i,"next",e)}function i(e){r(s,a,o,c,i,"throw",e)}c(void 0)}))}}var s,c,i,d,u,l,p,m,f,g,v,y,h,b,k,E,w,_,I,L,x,j,B,T,S,C,A,O,P,D,N,M,H,q,J,R,G,U,Y,z,F,V,K,$,Q,W,X,Z,ee,te,ne,ae,re,oe,se,ce,ie,de,ue,le,pe,me,fe,ge,ve,ye,he,be,ke,Ee,we,_e,Ie,Le,xe,je="https://real-time-task-manager-fac11501856a.herokuapp.com/api",Be=null,Te=null,Se=[],Ce=null;function Ae(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";P?(P.textContent=e,P.className="fixed bottom-4 left-1/2 -translate-x-1/2 p-3 rounded-md shadow-lg message-fade ".concat("success"===t?"bg-green-600":"error"===t?"bg-red-600":"bg-gray-800"," text-white"),P.classList.remove("hidden"),setTimeout((function(){P.classList.add("hidden")}),3e3)):console.log("Message (globalMessageDiv not ready):",e)}function Oe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error";if(y){var n;n=e.errors&&Array.isArray(e.errors)?e.errors.map((function(e){return e.msg})).join("; "):e.message?e.message:"An unknown error occurred during authentication.",y.textContent=n,y.className="mt-4 text-center ".concat("error"===t?"text-red-600":"text-green-600")}else console.log("Auth Message (authMessageDiv not ready):",e)}function Pe(){p&&l&&(arguments.length>0&&void 0!==arguments[0]&&!arguments[0]?(p.classList.add("hidden"),l.classList.remove("hidden")):(p.classList.remove("hidden"),l.classList.add("hidden"))),y&&(y.textContent="")}function De(e){return Ne.apply(this,arguments)}function Ne(){return Ne=o(n().m((function e(t){var a,r,o,s,c,i,d,u=arguments;return n().w((function(e){for(;;)switch(e.n){case 0:return a=u.length>1&&void 0!==u[1]?u[1]:"GET",r=u.length>2&&void 0!==u[2]?u[2]:null,o={"Content-Type":"application/json"},Te&&(o.Authorization="Bearer ".concat(Te)),s={method:a,headers:o},r&&(s.body=JSON.stringify(r)),e.p=1,e.n=2,fetch("".concat(je).concat(t),s);case 2:return c=e.v,e.n=3,c.json();case 3:if(i=e.v,c.ok){e.n=4;break}throw i;case 4:return e.a(2,i);case 5:if(e.p=5,d=e.v,console.error("API call error:",d),!(d instanceof TypeError)){e.n=6;break}throw{message:"Network error or server unreachable. Please try again."};case 6:throw d;case 7:return e.a(2)}}),e,null,[[1,5]])}))),Ne.apply(this,arguments)}function Me(e){return He.apply(this,arguments)}function He(){return(He=o(n().m((function e(t){var a,r,o;return n().w((function(e){for(;;)switch(e.n){case 0:return t.preventDefault(),a=q.value,r=J.value,o=R.value,e.p=1,e.n=2,De("/auth/register","POST",{username:a,email:r,password:o});case 2:e.v,Ae("Registration successful! Please log in.","success"),Pe(!0),q.value="",J.value="",R.value="",e.n=4;break;case 3:e.p=3,Oe(e.v);case 4:return e.a(2)}}),e,null,[[1,3]])})))).apply(this,arguments)}function qe(e){return Je.apply(this,arguments)}function Je(){return(Je=o(n().m((function e(t){var a,r,o;return n().w((function(e){for(;;)switch(e.n){case 0:return t.preventDefault(),a=G.value,r=U.value,e.p=1,e.n=2,De("/auth/login","POST",{email:a,password:r});case 2:o=e.v,Te=o.token,Be=o.user,localStorage.setItem("jwt_token",Te),localStorage.setItem("current_user",JSON.stringify(Be)),Ge(),Ae("Logged in successfully!","success"),G.value="",U.value="",e.n=4;break;case 3:e.p=3,Oe(e.v);case 4:return e.a(2)}}),e,null,[[1,3]])})))).apply(this,arguments)}function Re(){Te=null,Be=null,localStorage.removeItem("jwt_token"),localStorage.removeItem("current_user"),location.reload()}function Ge(){Te&&Be?(c&&i&&d&&(c.classList.add("hidden"),i.classList.remove("hidden"),d.textContent=Be.username),s&&s.connected?console.log("Socket.IO already connected."):((s=io(je.replace("/api",""),{})).on("connect",(function(){console.log("Socket.IO: Connected to server with ID: ".concat(s.id)),Ae("Real-time connection established!","success")})),s.on("disconnect",(function(){console.log("Socket.IO: Disconnected from server"),Ae("Real-time connection lost.","error")})),s.on("connect_error",(function(e){console.error("Socket.IO Connection Error:",e),Ae("Real-time connection error.","error")})),s.on("taskCreated",(function(e){Ae('New Task: "'.concat(e.task.title,'" created!'),"success"),lt(Ce,w.textContent,wt()),Ue()})),s.on("taskUpdated",(function(e){Ae('Task: "'.concat(e.task.title,'" updated!'),"success"),lt(Ce,w.textContent,wt())})),s.on("taskDeleted",(function(e){Ae("Task deleted!","success"),lt(Ce,w.textContent,wt())})),s.on("taskTagAdded",(function(e){Ae("Tag added to task!","success"),lt(Ce,w.textContent,wt())})),s.on("taskTagRemoved",(function(e){Ae("Tag removed from task!","success"),lt(Ce,w.textContent,wt())})),s.on("projectCreated",(function(e){Ae('New Project: "'.concat(e.project.name,'" created!'),"success"),Ue()})),s.on("projectUpdated",(function(e){Ae('Project: "'.concat(e.project.name,'" updated!'),"success"),Ue()})),s.on("projectDeleted",(function(e){Ae("Project deleted!","success"),Ue(),lt()})),s.on("newNotification",(function(e){Ae(e.message,"info"),Lt()})),s.on("test_response",(function(e){console.log("Received test_response:",e),Ae(e.message,"info")}))),Ue(),function(){nt.apply(this,arguments)}(),at(),lt(),Lt()):(c&&i&&(c.classList.remove("hidden"),i.classList.add("hidden")),Pe(!0))}function Ue(){return Ye.apply(this,arguments)}function Ye(){return(Ye=o(n().m((function e(){var t,a;return n().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,De("/projects");case 1:t=e.v,k&&(k.innerHTML="",0===t.projects.length?E.classList.remove("hidden"):(E.classList.add("hidden"),t.projects.forEach((function(e){return ze(e)})))),n=t.projects,S&&(S.innerHTML='<option value="">Select Project...</option>',n.filter((function(e){return!e.is_deleted})).forEach((function(e){var t=document.createElement("option");t.value=e.id,t.textContent=e.name,S.appendChild(t)}))),et(t.projects),e.n=3;break;case 2:e.p=2,a=e.v,Ae("Error fetching projects: ".concat(a.message),"error");case 3:return e.a(2)}var n}),e,null,[[0,2]])})))).apply(this,arguments)}function ze(e){if(k){var t=document.createElement("div");t.id="project-".concat(e.id);var n=e.is_deleted?"border-red-700":"border-purple-500",a=e.is_deleted?"bg-red-100":"bg-white";t.className="".concat(a," p-4 rounded-md shadow-sm flex justify-between items-center border-l-4 ").concat(n),t.innerHTML='\n        <div>\n            <h4 class="text-lg font-semibold text-gray-800">'.concat(e.name," ").concat(e.is_deleted?"(Deleted)":"",'</h4>\n            <p class="text-sm text-gray-600">').concat(e.description||"No description",'</p>\n        </div>\n        <div class="flex space-x-2">\n            <button data-id="').concat(e.id,'" class="view-tasks-btn bg-blue-500 text-white p-2 rounded-md text-sm hover:bg-blue-600 transition shadow-sm">View Tasks</button>\n            <button data-id="').concat(e.id,'" data-name="').concat(e.name,'" data-description="').concat(e.description||"",'" class="edit-project-btn bg-yellow-500 text-white p-2 rounded-md text-sm hover:bg-yellow-600 transition shadow-sm">Edit</button>\n            <button data-id="').concat(e.id,'" class="delete-project-btn bg-red-500 text-white p-2 rounded-md text-sm hover:bg-red-600 transition shadow-sm">Delete</button>\n        </div>\n    '),k.appendChild(t),t.querySelector(".view-tasks-btn").addEventListener("click",(function(t){Ce=e.id,lt(e.id,e.name)}));var r=t.querySelector(".edit-project-btn");r.addEventListener("click",(function(e){!function(e){se&&(de.value=e.id,ue.value=e.name,le.value=e.description,se.classList.remove("hidden"))}({id:e.target.dataset.id,name:e.target.dataset.name,description:e.target.dataset.description})}));var o=t.querySelector(".delete-project-btn");o.addEventListener("click",(function(t){var n=t.target.dataset.id,a=e.created_by;"admin"===Be.role||Be.user_id===a?confirm('Are you sure you want to delete project "'.concat(e.name,'"? This will also soft-delete all associated tasks.'))&&function(e){Ze.apply(this,arguments)}(n):(Ae("You do not have permission to delete this project.","error"),o.disabled=!0,o.classList.add("opacity-50","cursor-not-allowed"))})),(e.is_deleted||"admin"!==Be.role&&Be.user_id!==e.created_by)&&(r.disabled=!0,r.classList.add("opacity-50","cursor-not-allowed"),o.disabled=!0,o.classList.add("opacity-50","cursor-not-allowed"))}}function Fe(){se&&(se.classList.add("hidden"),ce.reset())}function Ve(e){return Ke.apply(this,arguments)}function Ke(){return(Ke=o(n().m((function e(t){var a,r,o,s;return n().w((function(e){for(;;)switch(e.n){case 0:return t.preventDefault(),a=de.value,r=ue.value,o=le.value,e.p=1,e.n=2,We(a,r,o);case 2:Ae("Project updated successfully!","success"),Fe(),e.n=4;break;case 3:e.p=3,s=e.v,Ae("Error updating project: ".concat(s.message),"error");case 4:return e.a(2)}}),e,null,[[1,3]])})))).apply(this,arguments)}function $e(e){return Qe.apply(this,arguments)}function Qe(){return(Qe=o(n().m((function e(t){var a,r;return n().w((function(e){for(;;)switch(e.n){case 0:if(t.preventDefault(),b){e.n=1;break}return e.a(2);case 1:if(a=b.value){e.n=2;break}return Ae("Project name cannot be empty.","error"),e.a(2);case 2:return e.p=2,e.n=3,De("/projects","POST",{name:a,description:""});case 3:b.value="",Ae("Project created!","success"),e.n=5;break;case 4:e.p=4,r=e.v,Ae("Error creating project: ".concat(r.message),"error");case 5:return e.a(2)}}),e,null,[[2,4]])})))).apply(this,arguments)}function We(e,t,n){return Xe.apply(this,arguments)}function Xe(){return(Xe=o(n().m((function e(t,a,r){var o;return n().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,De("/projects/".concat(t),"PUT",{name:a,description:r});case 1:Ae("Project updated!","success"),e.n=3;break;case 2:e.p=2,o=e.v,Ae("Error updating project: ".concat(o.message),"error");case 3:return e.a(2)}}),e,null,[[0,2]])})))).apply(this,arguments)}function Ze(){return(Ze=o(n().m((function e(t){var a;return n().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,De("/projects/".concat(t),"DELETE");case 1:Ae("Project deleted!","success"),e.n=3;break;case 2:e.p=2,a=e.v,Ae("Error deleting project: ".concat(a.message),"error");case 3:return e.a(2)}}),e,null,[[0,2]])})))).apply(this,arguments)}function et(e){if(te){te.innerHTML="";var t=document.createElement("option");t.value="",t.textContent="Select Project...",te.appendChild(t),e.filter((function(e){return!e.is_deleted})).forEach((function(e){var t=document.createElement("option");t.value=e.id,t.textContent=e.name,te.appendChild(t)}))}}var tt=[];function nt(){return(nt=o(n().m((function e(){var t,a;return n().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,De("/users");case 1:t=e.v,tt=t.users,T&&ee&&be&&(T.innerHTML='<option value="">Assign to...</option>',ee.innerHTML='<option value="">Assign to...</option>',be.innerHTML='<option value="">All Assignees</option>',tt.forEach((function(e){var t=document.createElement("option");t.value=e.id,t.textContent=e.username,T.appendChild(t),ee.appendChild(t.cloneNode(!0)),be.appendChild(t.cloneNode(!0))}))),e.n=3;break;case 2:e.p=2,a=e.v,console.warn("Could not fetch users for assignment. Skipping user dropdown population. Error:",a.message),Ae("Could not load users for assignment: ".concat(a.message),"error");case 3:return e.a(2)}}),e,null,[[0,2]])})))).apply(this,arguments)}function at(){return rt.apply(this,arguments)}function rt(){return(rt=o(n().m((function e(){var t,a,r;return n().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,De("/tags");case 1:t=e.v,Se=t.tags,fe&&(fe.innerHTML="",0===(a=Se.filter((function(e){return!e.is_deleted}))).length?ge.classList.remove("hidden"):(ge.classList.add("hidden"),a.forEach((function(e){return ot(e)})))),n=Se,re&&(re.innerHTML="",n.filter((function(e){return!e.is_deleted})).forEach((function(e){var t=document.createElement("option");t.value=e.id,t.textContent=e.name,re.appendChild(t)}))),dt(Se),ut(Se),e.n=3;break;case 2:e.p=2,r=e.v,console.warn("Could not fetch tags. Error:",r.message),Ae("Could not load tags: ".concat(r.message),"error");case 3:return e.a(2)}var n}),e,null,[[0,2]])})))).apply(this,arguments)}function ot(e){if(fe){var t=document.createElement("div");t.id="tag-".concat(e.id);var n=e.is_deleted?"bg-gray-300":"bg-gray-200",a=e.is_deleted?"text-gray-500":"text-gray-700";t.className="".concat(n," rounded-full px-4 py-2 text-sm font-semibold ").concat(a," flex items-center justify-between shadow-sm"),t.innerHTML="\n        <span>".concat(e.name," ").concat(e.is_deleted?"(Deleted)":"",'</span>\n        <button data-id="').concat(e.id,'" class="delete-tag-btn ml-2 text-red-500 hover:text-red-700 transition">\n            &times;\n        </button>\n    '),fe.appendChild(t);var r=t.querySelector(".delete-tag-btn");r.addEventListener("click",(function(t){var n=t.target.dataset.id,a=e.created_by;"admin"===Be.role||Be.user_id===a?confirm('Are you sure you want to delete tag "'.concat(e.name,'"? This will soft-delete it.'))&&function(e){it.apply(this,arguments)}(n):(Ae("You do not have permission to delete this tag.","error"),r.disabled=!0,r.classList.add("opacity-50","cursor-not-allowed"))})),(e.is_deleted||"admin"!==Be.role&&Be.user_id!==e.created_by)&&(r.disabled=!0,r.classList.add("opacity-50","cursor-not-allowed"))}}function st(e){return ct.apply(this,arguments)}function ct(){return(ct=o(n().m((function e(t){var a,r;return n().w((function(e){for(;;)switch(e.n){case 0:if(t.preventDefault(),me){e.n=1;break}return e.a(2);case 1:if(a=me.value.trim()){e.n=2;break}return Ae("Tag name cannot be empty.","error"),e.a(2);case 2:return e.p=2,e.n=3,De("/tags","POST",{name:a});case 3:me.value="",Ae("Tag created!","success"),at(),e.n=5;break;case 4:e.p=4,r=e.v,Ae("Error creating tag: ".concat(r.message),"error");case 5:return e.a(2)}}),e,null,[[2,4]])})))).apply(this,arguments)}function it(){return(it=o(n().m((function e(t){var a;return n().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,De("/tags/".concat(t),"DELETE");case 1:Ae("Tag deleted!","success"),at(),e.n=3;break;case 2:e.p=2,a=e.v,Ae("Error deleting tag: ".concat(a.message),"error");case 3:return e.a(2)}}),e,null,[[0,2]])})))).apply(this,arguments)}function dt(e){ae&&(ae.innerHTML="",e.filter((function(e){return!e.is_deleted})).forEach((function(e){var t=document.createElement("option");t.value=e.id,t.textContent=e.name,ae.appendChild(t)})))}function ut(e){ke&&(ke.innerHTML="",e.filter((function(e){return!e.is_deleted})).forEach((function(e){var t=document.createElement("option");t.value=e.id,t.textContent=e.name,ke.appendChild(t)})))}function lt(){return pt.apply(this,arguments)}function pt(){return pt=o(n().m((function e(){var t,a,r,o,s,c,i,d=arguments;return n().w((function(e){for(;;)switch(e.n){case 0:return t=d.length>0&&void 0!==d[0]?d[0]:null,a=d.length>1&&void 0!==d[1]?d[1]:"All Projects",r=d.length>2&&void 0!==d[2]?d[2]:{},w&&(w.textContent=a),o=new URLSearchParams,t&&o.append("project_id",t),r.search&&o.append("search",r.search),r.priority&&o.append("priority",r.priority),r.status&&o.append("status",r.status),r.assigned_to&&o.append("assigned_to",r.assigned_to),r.tags&&r.tags.length>0&&o.append("tags",r.tags.join(",")),r.due_date_start&&o.append("due_date_start",r.due_date_start),r.due_date_end&&o.append("due_date_end",r.due_date_end),r.order_by&&o.append("order_by",r.order_by),r.order_direction&&o.append("order_direction",r.order_direction),s="/tasks?".concat(o.toString()),e.p=1,e.n=2,De(s);case 2:c=e.v,A&&(A.innerHTML="",0===c.tasks.length?O.classList.remove("hidden"):(O.classList.add("hidden"),c.tasks.forEach((function(e){return mt(e)})))),e.n=4;break;case 3:e.p=3,i=e.v,Te?Ae("Error fetching tasks: ".concat(i.message),"error"):console.warn("Initial task fetch unauthorized (expected before login): ".concat(i.message));case 4:return e.a(2)}}),e,null,[[1,3]])}))),pt.apply(this,arguments)}function mt(e){if(A){var t=document.createElement("div");t.id="task-".concat(e.id);var a=e.is_deleted?"border-red-700":"border-yellow-500",r=e.is_deleted?"bg-red-100":"bg-white";t.className="".concat(r," p-4 rounded-md shadow-sm flex justify-between items-start border-l-4 ").concat(a);var s=e.tags?e.tags.map((function(t){return'\n        <span class="inline-flex items-center bg-gray-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2">\n            '.concat(t.name,'\n            <button data-task-id="').concat(e.id,'" data-tag-id="').concat(t.id,'" class="remove-tag-btn ml-1 text-gray-500 hover:text-red-700 transition text-xs font-bold">&times;</button>\n        </span>\n    ')})).join(""):"";t.innerHTML='\n        <div class="flex-grow">\n            <h4 class="text-lg font-semibold text-gray-800">'.concat(e.title," ").concat(e.is_deleted?"(Deleted)":"",'</h4>\n            <p class="text-sm text-gray-600 mb-2">').concat(e.description||"No description",'</p>\n            <p class="text-xs text-gray-500 mb-2">\n                Due: ').concat(e.due_date?new Date(e.due_date).toLocaleDateString():"N/A",' |\n                Priority: <span class="font-medium text-').concat(function(e){switch(e){case"urgent":return"red-600";case"high":return"orange-600";case"medium":return"blue-600";case"low":return"green-600";default:return"gray-600"}}(e.priority),'">').concat(e.priority,'</span> |\n                Status: <span class="font-medium text-').concat(function(e){switch(e){case"completed":return"green-600";case"in-progress":return"blue-600";case"blocked":return"red-600";case"pending":return"yellow-600";default:return"gray-600"}}(e.status),'">').concat(e.status,'</span>\n            </p>\n            <p class="text-xs text-gray-500 mb-2">\n                Project: ').concat(e.project_name||"N/A"," | Assigned To: ").concat(e.assigned_to_username||"Unassigned",'\n            </p>\n            <div class="mt-2">').concat(s,'</div>\n        </div>\n        <div class="flex flex-col space-y-2 ml-4">\n            <button data-id="').concat(e.id,'" \n                    data-title="').concat(e.title,'" \n                    data-description="').concat(e.description||"",'"\n                    data-due-date="').concat(e.due_date?new Date(e.due_date).toISOString().split("T")[0]:"",'"\n                    data-priority="').concat(e.priority,'"\n                    data-status="').concat(e.status,'"\n                    data-assigned-to="').concat(e.assigned_to||"",'"\n                    data-project-id="').concat(e.project_id,'"\n                    data-parent-task-id="').concat(e.parent_task_id||"","\"\n                    data-tags='").concat(JSON.stringify(e.tags||[]),'\'\n                    class="edit-task-btn bg-yellow-500 text-white p-2 rounded-md text-sm hover:bg-yellow-600 transition shadow-sm">Edit</button>\n            <button data-id="').concat(e.id,'" class="delete-task-btn bg-red-500 text-white p-2 rounded-md text-sm hover:bg-red-600 transition shadow-sm">Delete</button>\n        </div>\n    '),A.appendChild(t);var c=t.querySelector(".edit-task-btn");c.addEventListener("click",(function(t){var n={id:t.target.dataset.id,title:t.target.dataset.title,description:t.target.dataset.description,due_date:t.target.dataset.dueDate,priority:t.target.dataset.priority,status:t.target.dataset.status,assigned_to:e.assigned_to||"",project_id:e.project_id,parent_task_id:e.parent_task_id||"",tags:JSON.parse(t.target.dataset.tags||"[]")},a=e.created_by,r=e.assigned_to;"admin"===Be.role||Be.user_id===a||Be.user_id===r?function(e){Y&&(V.value=e.id,K.value=e.project_id,oe.value=JSON.stringify(e.tags||[]),$.value=e.title,Q.value=e.description,W.value=e.due_date,X.value=e.priority,Z.value=e.status,ee.value=e.assigned_to||"",te.value=e.project_id||"",ne.value=e.parent_task_id,ae&&(Array.from(ae.options).forEach((function(e){e.selected=!1})),e.tags.forEach((function(e){var t=ae.querySelector('option[value="'.concat(e.id,'"]'));t&&(t.selected=!0)}))),Y.classList.remove("hidden"))}(n):(Ae("You do not have permission to edit this task.","error"),c.disabled=!0,c.classList.add("opacity-50","cursor-not-allowed"))}));var i=t.querySelector(".delete-task-btn");i.addEventListener("click",(function(t){var n=t.target.dataset.id,a=e.created_by;"admin"===Be.role||Be.user_id===a?confirm('Are you sure you want to delete task "'.concat(e.title,'"? This will soft-delete it.'))&&function(e){Et.apply(this,arguments)}(n):(Ae("You do not have permission to delete this task.","error"),i.disabled=!0,i.classList.add("opacity-50","cursor-not-allowed"))})),t.querySelectorAll(".remove-tag-btn").forEach((function(t){var a=t;a.addEventListener("click",function(){var t=o(n().m((function t(r){var o,s,c,i;return n().w((function(t){for(;;)switch(t.n){case 0:if(o=r.target.dataset.taskId,s=r.target.dataset.tagId,c=e.created_by,"admin"!==Be.role&&Be.user_id!==c){t.n=5;break}if(!confirm("Are you sure you want to remove this tag from the task?")){t.n=4;break}return t.p=1,t.n=2,De("/tasks/".concat(o,"/tags/").concat(s),"DELETE");case 2:Ae("Tag removed from task!","success"),lt(Ce,w.textContent,wt()),t.n=4;break;case 3:t.p=3,i=t.v,Ae("Error removing tag: ".concat(i.message),"error");case 4:t.n=6;break;case 5:Ae("You do not have permission to remove tags from this task.","error"),a.disabled=!0,a.classList.add("opacity-50","cursor-not-allowed");case 6:return t.a(2)}}),t,null,[[1,3]])})));return function(e){return t.apply(this,arguments)}}()),(e.is_deleted||"admin"!==Be.role&&Be.user_id!==e.created_by)&&(a.disabled=!0,a.classList.add("opacity-50","cursor-not-allowed"))})),e.is_deleted&&(c.disabled=!0,c.classList.add("opacity-50","cursor-not-allowed"),i.disabled=!0,i.classList.add("opacity-50","cursor-not-allowed"))}}function ft(){Y&&(Y.classList.add("hidden"),z.reset(),ae&&Array.from(ae.options).forEach((function(e){return e.selected=!1})),oe.value="")}function gt(e){return vt.apply(this,arguments)}function vt(){return(vt=o(n().m((function t(a){var r,o,s,c,i,d,u,l,p,m,f,g,v,y,h;return n().w((function(t){for(;;)switch(t.n){case 0:return a.preventDefault(),r=V.value,K.value,o={title:$.value,description:Q.value,due_date:W.value||null,priority:X.value,status:Z.value,assigned_to:ee.value?parseInt(ee.value):null,project_id:te.value?parseInt(te.value):null,parent_task_id:ne.value?parseInt(ne.value):null},s=Array.from(ae.selectedOptions).map((function(e){return parseInt(e.value)})),t.p=1,t.n=2,bt(r,o);case 2:Ae("Task updated successfully!","success"),ft(),c=JSON.parse(oe.value||"[]"),i=s.filter((function(e){return!c.some((function(t){return t.id===e}))})),d=c.filter((function(e){return!s.includes(e.id)})).map((function(e){return e.id})),u=e(d),t.p=3,u.s();case 4:if((l=u.n()).done){t.n=6;break}return p=l.value,t.n=5,De("/tasks/".concat(r,"/tags/").concat(p),"DELETE");case 5:t.n=4;break;case 6:t.n=8;break;case 7:t.p=7,v=t.v,u.e(v);case 8:return t.p=8,u.f(),t.f(8);case 9:m=e(i),t.p=10,m.s();case 11:if((f=m.n()).done){t.n=13;break}return g=f.value,t.n=12,De("/tasks/".concat(r,"/tags/").concat(g),"POST");case 12:t.n=11;break;case 13:t.n=15;break;case 14:t.p=14,y=t.v,m.e(y);case 15:return t.p=15,m.f(),t.f(15);case 16:lt(Ce,w.textContent,wt()),t.n=18;break;case 17:t.p=17,h=t.v,Ae("Error updating task: ".concat(h.message),"error");case 18:return t.a(2)}}),t,null,[[10,14,15,16],[3,7,8,9],[1,17]])})))).apply(this,arguments)}function yt(e){return ht.apply(this,arguments)}function ht(){return(ht=o(n().m((function t(a){var r,o,s,c,i,d,u,l,p,m,f,g,v,y,h,b;return n().w((function(t){for(;;)switch(t.n){case 0:if(a.preventDefault(),I&&S){t.n=1;break}return t.a(2);case 1:if(r=I.value,o=L.value,s=x.value||null,c=j.value,i=B.value,d=T.value||null,u=S.value,l=C.value||null,p=Array.from(re.selectedOptions).map((function(e){return parseInt(e.value)})),r&&u){t.n=2;break}return Ae("Task title and project must be selected.","error"),t.a(2);case 2:return t.p=2,t.n=3,De("/tasks","POST",{title:r,description:o,due_date:s,priority:c,status:i,assigned_to:d?parseInt(d):null,project_id:parseInt(u),parent_task_id:l?parseInt(l):null});case 3:m=t.v,f=m.task.id,g=e(p),t.p=4,g.s();case 5:if((v=g.n()).done){t.n=7;break}return y=v.value,t.n=6,De("/tasks/".concat(f,"/tags/").concat(y),"POST");case 6:t.n=5;break;case 7:t.n=9;break;case 8:t.p=8,h=t.v,g.e(h);case 9:return t.p=9,g.f(),t.f(9);case 10:Ae("Task created!","success"),_.reset(),Array.from(re.options).forEach((function(e){return e.selected=!1})),ae&&Array.from(ae.options).forEach((function(e){return e.selected=!1})),lt(Ce,w.textContent,wt()),t.n=12;break;case 11:t.p=11,b=t.v,Ae("Error creating task: ".concat(b.message),"error");case 12:return t.a(2)}}),t,null,[[4,8,9,10],[2,11]])})))).apply(this,arguments)}function bt(e,t){return kt.apply(this,arguments)}function kt(){return(kt=o(n().m((function e(t,a){var r;return n().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,void 0!==a.assigned_to&&null!==a.assigned_to&&(a.assigned_to=a.assigned_to?parseInt(a.assigned_to):null),e.n=1,De("/tasks/".concat(t),"PUT",a);case 1:Ae("Task updated!","success"),e.n=3;break;case 2:e.p=2,r=e.v,Ae("Error updating task: ".concat(r.message),"error");case 3:return e.a(2)}}),e,null,[[0,2]])})))).apply(this,arguments)}function Et(){return(Et=o(n().m((function e(t){var a;return n().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,De("/tasks/".concat(t),"DELETE");case 1:Ae("Task deleted!","success"),e.n=3;break;case 2:e.p=2,a=e.v,Ae("Error deleting task: ".concat(a.message),"error");case 3:return e.a(2)}}),e,null,[[0,2]])})))).apply(this,arguments)}function wt(){return{search:ve.value.trim(),priority:ye.value,status:he.value,assigned_to:be.value||null,tags:Array.from(ke.selectedOptions).map((function(e){return parseInt(e.value)})),due_date_start:_e.value||null,due_date_end:Ie.value||null,order_by:Le.value,order_direction:xe.value}}function _t(){var e=wt();lt(Ce,w.textContent,e)}function It(){ve.value="",ye.value="",he.value="",be.value="",Array.from(ke.options).forEach((function(e){return e.selected=!1})),_e.value="",Ie.value="",Le.value="created_at",xe.value="DESC",lt(Ce,w.textContent)}function Lt(){return xt.apply(this,arguments)}function xt(){return(xt=o(n().m((function e(){var t,a;return n().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,De("/notifications");case 1:r=(t=e.v).notifications,N&&(N.innerHTML="",0!==r.length?(r.forEach((function(e){var t=document.createElement("li");t.className="p-3 mb-2 rounded-md shadow-sm ".concat(e.is_read?"bg-gray-100 text-gray-700":"bg-blue-50 text-blue-800 font-semibold"),t.dataset.notificationId=e.id;var n="";"TASK"===e.entity_type&&e.entity_id?n=' (<a href="#" data-task-id="'.concat(e.entity_id,'" class="notification-task-link text-blue-600 hover:underline">View Task</a>)'):"PROJECT"===e.entity_type&&e.entity_id&&(n=' (<a href="#" data-project-id="'.concat(e.entity_id,'" class="notification-project-link text-blue-600 hover:underline">View Project</a>)')),t.innerHTML="\n            ".concat(e.message," ").concat(n,'\n            <span class="block text-xs text-right ').concat(e.is_read?"text-gray-500":"text-blue-600",'">\n                ').concat(new Date(e.created_at).toLocaleString(),"\n            </span>\n        "),N.appendChild(t)})),N.querySelectorAll(".notification-task-link").forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault();var t=e.target.dataset.taskId;Ae("Clicked to view Task ID: ".concat(t),"info")}))})),N.querySelectorAll(".notification-project-link").forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault();var t=e.target.dataset.projectId;Ae("Clicked to view Project ID: ".concat(t),"info")}))}))):N.innerHTML='<li class="text-center text-gray-500">No notifications.</li>'),n=t.notifications.filter((function(e){return!e.is_read})).length,M&&(n>0?(M.textContent=n,M.classList.remove("hidden")):M.classList.add("hidden")),e.n=3;break;case 2:e.p=2,a=e.v,Ae("Error fetching notifications: ".concat(a.message),"error");case 3:return e.a(2)}var n,r}),e,null,[[0,2]])})))).apply(this,arguments)}function jt(){return Bt.apply(this,arguments)}function Bt(){return(Bt=o(n().m((function e(){var t,a;return n().w((function(e){for(;;)switch(e.n){case 0:if(0!==(t=Array.from(N.children).filter((function(e){return!e.classList.contains("bg-gray-100")})).map((function(e){return parseInt(e.dataset.notificationId)}))).length){e.n=1;break}return Ae("No unread notifications to clear.","info"),e.a(2);case 1:return e.p=1,e.n=2,De("/notifications/mark-read","POST",{notificationIds:t});case 2:Ae("Notifications cleared!","success"),Lt(),e.n=4;break;case 3:e.p=3,a=e.v,Ae("Error clearing notifications: ".concat(a.message),"error");case 4:return e.a(2)}}),e,null,[[1,3]])})))).apply(this,arguments)}function Tt(){D&&(D.classList.toggle("hidden"),D.classList.contains("hidden")||Lt())}document.addEventListener("DOMContentLoaded",(function(){c=document.getElementById("auth-section"),i=document.getElementById("main-app-section"),d=document.getElementById("welcome-username"),u=document.getElementById("logout-btn"),P=document.getElementById("global-message"),l=document.getElementById("register-form"),p=document.getElementById("login-form"),m=document.getElementById("show-login-btn"),f=document.getElementById("show-register-btn"),g=document.getElementById("register-btn"),v=document.getElementById("login-btn"),y=document.getElementById("auth-message"),q=document.getElementById("register-username"),J=document.getElementById("register-email"),R=document.getElementById("register-password"),G=document.getElementById("login-email"),U=document.getElementById("login-password"),document.getElementById("projects-section"),h=document.getElementById("create-project-form"),b=document.getElementById("project-name"),k=document.getElementById("projects-list"),E=document.getElementById("no-projects-message"),document.getElementById("tasks-section"),w=document.getElementById("current-project-name"),_=document.getElementById("create-task-form"),I=document.getElementById("task-title"),L=document.getElementById("task-description"),x=document.getElementById("task-due-date"),j=document.getElementById("task-priority"),B=document.getElementById("task-status"),T=document.getElementById("task-assigned-to"),S=document.getElementById("task-project-id"),C=document.getElementById("task-parent-task-id"),A=document.getElementById("tasks-list"),O=document.getElementById("no-tasks-message"),re=document.getElementById("task-tags"),Y=document.getElementById("edit-task-modal"),z=document.getElementById("edit-task-form"),F=document.getElementById("cancel-edit-task-btn"),V=document.getElementById("edit-task-id"),K=document.getElementById("edit-task-original-project-id"),$=document.getElementById("edit-task-title"),Q=document.getElementById("edit-task-description"),W=document.getElementById("edit-task-due-date"),X=document.getElementById("edit-task-priority"),Z=document.getElementById("edit-task-status"),ee=document.getElementById("edit-task-assigned-to"),te=document.getElementById("edit-task-project-id"),ne=document.getElementById("edit-task-parent-task-id"),ae=document.getElementById("edit-task-tags"),oe=document.getElementById("edit-task-original-tags"),se=document.getElementById("edit-project-modal"),ce=document.getElementById("edit-project-form"),ie=document.getElementById("cancel-edit-project-btn"),de=document.getElementById("edit-project-id"),ue=document.getElementById("edit-project-name"),le=document.getElementById("edit-project-description"),document.getElementById("tags-section"),pe=document.getElementById("create-tag-form"),me=document.getElementById("tag-name"),fe=document.getElementById("tags-list"),ge=document.getElementById("no-tags-message"),ve=document.getElementById("task-filter-search"),ye=document.getElementById("task-filter-priority"),he=document.getElementById("task-filter-status"),be=document.getElementById("task-filter-assigned-to"),ke=document.getElementById("task-filter-tags"),Ee=document.getElementById("apply-filters-btn"),we=document.getElementById("clear-filters-btn"),_e=document.getElementById("task-filter-due-date-start"),Ie=document.getElementById("task-filter-due-date-end"),Le=document.getElementById("task-filter-order-by"),xe=document.getElementById("task-filter-order-direction"),D=document.getElementById("notifications-container"),N=document.getElementById("notifications-list"),M=document.getElementById("notifications-badge"),H=document.getElementById("clear-notifications-btn");var e=document.getElementById("toggle-notifications-btn");m.addEventListener("click",(function(){return Pe(!0)})),f.addEventListener("click",(function(){return Pe(!1)})),g.addEventListener("click",Me),v.addEventListener("click",qe),u.addEventListener("click",Re),h.addEventListener("submit",$e),_.addEventListener("submit",yt),z.addEventListener("submit",gt),F.addEventListener("click",ft),Y.addEventListener("click",(function(e){e.target===Y&&ft()})),ce.addEventListener("submit",Ve),ie.addEventListener("click",Fe),se.addEventListener("click",(function(e){e.target===se&&Fe()})),pe&&pe.addEventListener("submit",st),Ee&&Ee.addEventListener("click",_t),we&&we.addEventListener("click",It),ve&&ve.addEventListener("input",_t),ye&&ye.addEventListener("change",_t),he&&he.addEventListener("change",_t),be&&be.addEventListener("change",_t),ke&&ke.addEventListener("change",_t),_e&&_e.addEventListener("change",_t),Ie&&Ie.addEventListener("change",_t),Le&&Le.addEventListener("change",_t),xe&&xe.addEventListener("change",_t),e&&e.addEventListener("click",Tt),H&&H.addEventListener("click",jt),Te=localStorage.getItem("jwt_token"),Be=JSON.parse(localStorage.getItem("current_user")),Ge(),Te||console.warn("Not logged in. Initial task fetch will be unauthorized (expected).")}))})();