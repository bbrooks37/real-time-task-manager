/*! For license information please see main.9484224e9374f5cf2cc7.js.LICENSE.txt */
(()=>{function e(e,n){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,n){if(e){if("string"==typeof e)return t(e,n);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){a&&(e=a);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,c=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return i=e.done,e},e:function(e){c=!0,s=e},f:function(){try{i||null==a.return||a.return()}finally{if(c)throw s}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function n(){var e,t,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",s=r.toStringTag||"@@toStringTag";function i(n,r,o,s){var i=r&&r.prototype instanceof d?r:d,u=Object.create(i.prototype);return a(u,"_invoke",function(n,a,r){var o,s,i,d=0,u=r||[],l=!1,p={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return o=t,s=0,i=e,p.n=n,c}};function m(n,a){for(s=n,i=a,t=0;!l&&d&&!r&&t<u.length;t++){var r,o=u[t],m=p.p,f=o[2];n>3?(r=f===a)&&(i=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=m&&((r=n<2&&m<o[1])?(s=0,p.v=a,p.n=o[1]):m<f&&(r=n<3||o[0]>a||a>f)&&(o[4]=n,o[5]=a,p.n=f,s=0))}if(r||n>1)return c;throw l=!0,a}return function(r,u,f){if(d>1)throw TypeError("Generator is already running");for(l&&1===u&&m(u,f),s=u,i=f;(t=s<2?e:i)||!l;){o||(s?s<3?(s>1&&(p.n=-1),m(s,i)):p.n=i:p.v=i);try{if(d=2,o){if(s||(r="next"),t=o[r]){if(!(t=t.call(o,i)))throw TypeError("iterator result is not an object");if(!t.done)return t;i=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(i=TypeError("The iterator does not provide a '"+r+"' method"),s=1);o=e}else if((t=(l=p.n<0)?i:n.call(a,p))!==c)break}catch(t){o=e,s=1,i=t}finally{d=1}}return{value:t,done:l}}}(n,o,s),!0),u}var c={};function d(){}function u(){}function l(){}t=Object.getPrototypeOf;var p=[][o]?t(t([][o]())):(a(t={},o,(function(){return this})),t),m=l.prototype=d.prototype=Object.create(p);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,a(e,s,"GeneratorFunction")),e.prototype=Object.create(m),e}return u.prototype=l,a(m,"constructor",l),a(l,"constructor",u),u.displayName="GeneratorFunction",a(l,s,"GeneratorFunction"),a(m),a(m,s,"Generator"),a(m,o,(function(){return this})),a(m,"toString",(function(){return"[object Generator]"})),(n=function(){return{w:i,m:f}})()}function a(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}a=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var s=function(t,n){a(e,t,(function(e){return this._invoke(t,n,e)}))};s("next",0),s("throw",1),s("return",2)}},a(e,t,n,r)}function r(e,t,n,a,r,o,s){try{var i=e[o](s),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(a,r)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(a,o){var s=e.apply(t,n);function i(e){r(s,a,o,i,c,"next",e)}function c(e){r(s,a,o,i,c,"throw",e)}i(void 0)}))}}var s,i,c,d,u,l,p,m,f,g,v,y,h,b,E,k,w,_,I,L,x,j,B,T,S,C,A,O,P,D,N,M,H,q,J,G,U,Y,z,F,R,V,K,$,Q,W,X,Z,ee,te,ne,ae,re,oe,se,ie,ce,de,ue,le,pe,me,fe,ge,ve,ye,he,be,Ee,ke,we,_e,Ie,Le,xe=null,je=null,Be=[],Te=null;function Se(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";O?(O.textContent=e,O.className="fixed bottom-4 left-1/2 -translate-x-1/2 p-3 rounded-md shadow-lg message-fade ".concat("success"===t?"bg-green-600":"error"===t?"bg-red-600":"bg-gray-800"," text-white"),O.classList.remove("hidden"),setTimeout((function(){O.classList.add("hidden")}),3e3)):console.log("Message (globalMessageDiv not ready):",e)}function Ce(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error";if(v){var n;n=e.errors&&Array.isArray(e.errors)?e.errors.map((function(e){return e.msg})).join("; "):e.message?e.message:"An unknown error occurred during authentication.",v.textContent=n,v.className="mt-4 text-center ".concat("error"===t?"text-red-600":"text-green-600")}else console.log("Auth Message (authMessageDiv not ready):",e)}function Ae(){l&&u&&(arguments.length>0&&void 0!==arguments[0]&&!arguments[0]?(l.classList.add("hidden"),u.classList.remove("hidden")):(l.classList.remove("hidden"),u.classList.add("hidden"))),v&&(authAuthMessageDiv.textContent="")}function Oe(e){return Pe.apply(this,arguments)}function Pe(){return Pe=o(n().m((function e(t){var a,r,o,s,i,c,d,u=arguments;return n().w((function(e){for(;;)switch(e.n){case 0:return a=u.length>1&&void 0!==u[1]?u[1]:"GET",r=u.length>2&&void 0!==u[2]?u[2]:null,o={"Content-Type":"application/json"},je&&(o.Authorization="Bearer ".concat(je)),s={method:a,headers:o},r&&(s.body=JSON.stringify(r)),e.p=1,e.n=2,fetch("".concat("https://real-time-task-manager-fac11501856a.herokuapp.com/api").concat(t),s);case 2:return i=e.v,e.n=3,i.json();case 3:if(c=e.v,i.ok){e.n=4;break}throw c;case 4:return e.a(2,c);case 5:if(e.p=5,d=e.v,console.error("API call error:",d),!(d instanceof TypeError)){e.n=6;break}throw{message:"Network error or server unreachable. Please try again."};case 6:throw d;case 7:return e.a(2)}}),e,null,[[1,5]])}))),Pe.apply(this,arguments)}function De(e){return Ne.apply(this,arguments)}function Ne(){return(Ne=o(n().m((function e(t){var a,r,o;return n().w((function(e){for(;;)switch(e.n){case 0:return t.preventDefault(),a=H.value,r=q.value,o=J.value,e.p=1,e.n=2,Oe("/auth/register","POST",{username:a,email:r,password:o});case 2:e.v,Se("Registration successful! Please log in.","success"),Ae(!0),H.value="",q.value="",J.value="",e.n=4;break;case 3:e.p=3,Ce(e.v);case 4:return e.a(2)}}),e,null,[[1,3]])})))).apply(this,arguments)}function Me(e){return He.apply(this,arguments)}function He(){return(He=o(n().m((function e(t){var a,r,o;return n().w((function(e){for(;;)switch(e.n){case 0:return t.preventDefault(),a=G.value,r=U.value,e.p=1,e.n=2,Oe("/auth/login","POST",{email:a,password:r});case 2:o=e.v,je=o.token,xe=o.user,localStorage.setItem("jwt_token",je),localStorage.setItem("current_user",JSON.stringify(xe)),Je(),Se("Logged in successfully!","success"),G.value="",U.value="",e.n=4;break;case 3:e.p=3,Ce(e.v);case 4:return e.a(2)}}),e,null,[[1,3]])})))).apply(this,arguments)}function qe(){je=null,xe=null,localStorage.removeItem("jwt_token"),localStorage.removeItem("current_user"),location.reload()}function Je(){je&&xe?(s&&i&&c&&(s.classList.add("hidden"),i.classList.remove("hidden"),c.textContent=xe.username),initializeSocketIO(),function(){Ge.apply(this,arguments)}(),function(){Ze.apply(this,arguments)}(),et(),ct(),wt()):(s&&i&&(s.classList.remove("hidden"),i.classList.add("hidden")),Ae(!0))}function Ge(){return(Ge=o(n().m((function e(){var t,a;return n().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Oe("/projects");case 1:t=e.v,b&&(b.innerHTML="",0===t.projects.length?E.classList.remove("hidden"):(E.classList.add("hidden"),t.projects.forEach((function(e){return Ue(e)})))),n=t.projects,T&&(T.innerHTML='<option value="">Select Project...</option>',n.filter((function(e){return!e.is_deleted})).forEach((function(e){var t=document.createElement("option");t.value=e.id,t.textContent=e.name,T.appendChild(t)}))),We(t.projects),e.n=3;break;case 2:e.p=2,a=e.v,Se("Error fetching projects: ".concat(a.message),"error");case 3:return e.a(2)}var n}),e,null,[[0,2]])})))).apply(this,arguments)}function Ue(e){if(b){var t=document.createElement("div");t.id="project-".concat(e.id);var n=e.is_deleted?"border-red-700":"border-purple-500",a=e.is_deleted?"bg-red-100":"bg-white";t.className="".concat(a," p-4 rounded-md shadow-sm flex justify-between items-center border-l-4 ").concat(n),t.innerHTML='\n        <div>\n            <h4 class="text-lg font-semibold text-gray-800">'.concat(e.name," ").concat(e.is_deleted?"(Deleted)":"",'</h4>\n            <p class="text-sm text-gray-600">').concat(e.description||"No description",'</p>\n        </div>\n        <div class="flex space-x-2">\n            <button data-id="').concat(e.id,'" class="view-tasks-btn bg-blue-500 text-white p-2 rounded-md text-sm hover:bg-blue-600 transition shadow-sm">View Tasks</button>\n            <button data-id="').concat(e.id,'" data-name="').concat(e.name,'" data-description="').concat(e.description||"",'" class="edit-project-btn bg-yellow-500 text-white p-2 rounded-md text-sm hover:bg-yellow-600 transition shadow-sm">Edit</button>\n            <button data-id="').concat(e.id,'" class="delete-project-btn bg-red-500 text-white p-2 rounded-md text-sm hover:bg-red-600 transition shadow-sm">Delete</button>\n        </div>\n    '),b.appendChild(t),t.querySelector(".view-tasks-btn").addEventListener("click",(function(t){Te=e.id,ct(e.id,e.name)}));var r=t.querySelector(".edit-project-btn");r.addEventListener("click",(function(e){!function(e){oe&&(ce.value=e.id,de.value=e.name,ue.value=e.description,oe.classList.remove("hidden"))}({id:e.target.dataset.id,name:e.target.dataset.name,description:e.target.dataset.description})}));var o=t.querySelector(".delete-project-btn");o.addEventListener("click",(function(t){var n=t.target.dataset.id,a=e.created_by;"admin"===xe.role||xe.user_id===a?confirm('Are you sure you want to delete project "'.concat(e.name,'"? This will also soft-delete all associated tasks.'))&&function(e){Qe.apply(this,arguments)}(n):(Se("You do not have permission to delete this project.","error"),o.disabled=!0,o.classList.add("opacity-50","cursor-not-allowed"))})),(e.is_deleted||"admin"!==xe.role&&xe.user_id!==e.created_by)&&(r.disabled=!0,r.classList.add("opacity-50","cursor-not-allowed"),o.disabled=!0,o.classList.add("opacity-50","cursor-not-allowed"))}}function Ye(){oe&&(oe.classList.add("hidden"),se.reset())}function ze(e){return Fe.apply(this,arguments)}function Fe(){return(Fe=o(n().m((function e(t){var a,r,o,s;return n().w((function(e){for(;;)switch(e.n){case 0:return t.preventDefault(),a=ce.value,r=de.value,o=ue.value,e.p=1,e.n=2,Ke(a,r,o);case 2:Se("Project updated successfully!","success"),Ye(),e.n=4;break;case 3:e.p=3,s=e.v,Se("Error updating project: ".concat(s.message),"error");case 4:return e.a(2)}}),e,null,[[1,3]])})))).apply(this,arguments)}function Re(e){return Ve.apply(this,arguments)}function Ve(){return(Ve=o(n().m((function e(t){var a,r;return n().w((function(e){for(;;)switch(e.n){case 0:if(t.preventDefault(),h){e.n=1;break}return e.a(2);case 1:if(a=h.value){e.n=2;break}return Se("Project name cannot be empty.","error"),e.a(2);case 2:return e.p=2,e.n=3,Oe("/projects","POST",{name:a,description:""});case 3:h.value="",Se("Project created!","success"),e.n=5;break;case 4:e.p=4,r=e.v,Se("Error creating project: ".concat(r.message),"error");case 5:return e.a(2)}}),e,null,[[2,4]])})))).apply(this,arguments)}function Ke(e,t,n){return $e.apply(this,arguments)}function $e(){return($e=o(n().m((function e(t,a,r){var o;return n().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Oe("/projects/".concat(t),"PUT",{name:a,description:r});case 1:Se("Project updated!","success"),e.n=3;break;case 2:e.p=2,o=e.v,Se("Error updating project: ".concat(o.message),"error");case 3:return e.a(2)}}),e,null,[[0,2]])})))).apply(this,arguments)}function Qe(){return(Qe=o(n().m((function e(t){var a;return n().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Oe("/projects/".concat(t),"DELETE");case 1:Se("Project deleted!","success"),e.n=3;break;case 2:e.p=2,a=e.v,Se("Error deleting project: ".concat(a.message),"error");case 3:return e.a(2)}}),e,null,[[0,2]])})))).apply(this,arguments)}function We(e){if(ee){ee.innerHTML="";var t=document.createElement("option");t.value="",t.textContent="Select Project...",ee.appendChild(t),e.filter((function(e){return!e.is_deleted})).forEach((function(e){var t=document.createElement("option");t.value=e.id,t.textContent=e.name,ee.appendChild(t)}))}}var Xe=[];function Ze(){return(Ze=o(n().m((function e(){var t,a;return n().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Oe("/users");case 1:t=e.v,Xe=t.users,B&&Z&&he&&(B.innerHTML='<option value="">Assign to...</option>',Z.innerHTML='<option value="">Assign to...</option>',he.innerHTML='<option value="">All Assignees</option>',Xe.forEach((function(e){var t=document.createElement("option");t.value=e.id,t.textContent=e.username,B.appendChild(t),Z.appendChild(t.cloneNode(!0)),he.appendChild(t.cloneNode(!0))}))),e.n=3;break;case 2:e.p=2,a=e.v,console.warn("Could not fetch users for assignment. Skipping user dropdown population. Error:",a.message),Se("Could not load users for assignment: ".concat(a.message),"error");case 3:return e.a(2)}}),e,null,[[0,2]])})))).apply(this,arguments)}function et(){return tt.apply(this,arguments)}function tt(){return(tt=o(n().m((function e(){var t,a,r;return n().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Oe("/tags");case 1:t=e.v,Be=t.tags,me&&(me.innerHTML="",0===(a=Be.filter((function(e){return!e.is_deleted}))).length?fe.classList.remove("hidden"):(fe.classList.add("hidden"),a.forEach((function(e){return nt(e)})))),n=Be,ae&&(ae.innerHTML="",n.filter((function(e){return!e.is_deleted})).forEach((function(e){var t=document.createElement("option");t.value=e.id,t.textContent=e.name,ae.appendChild(t)}))),st(Be),it(Be),e.n=3;break;case 2:e.p=2,r=e.v,console.warn("Could not fetch tags. Error:",r.message),Se("Could not load tags: ".concat(r.message),"error");case 3:return e.a(2)}var n}),e,null,[[0,2]])})))).apply(this,arguments)}function nt(e){if(me){var t=document.createElement("div");t.id="tag-".concat(e.id);var n=e.is_deleted?"bg-gray-300":"bg-gray-200",a=e.is_deleted?"text-gray-500":"text-gray-700";t.className="".concat(n," rounded-full px-4 py-2 text-sm font-semibold ").concat(a," flex items-center justify-between shadow-sm"),t.innerHTML="\n        <span>".concat(e.name," ").concat(e.is_deleted?"(Deleted)":"",'</span>\n        <button data-id="').concat(e.id,'" class="delete-tag-btn ml-2 text-red-500 hover:text-red-700 transition">\n            &times;\n        </button>\n    '),me.appendChild(t);var r=t.querySelector(".delete-tag-btn");r.addEventListener("click",(function(t){var n=t.target.dataset.id,a=e.created_by;"admin"===xe.role||xe.user_id===a?confirm('Are you sure you want to delete tag "'.concat(e.name,'"? This will soft-delete it.'))&&function(e){ot.apply(this,arguments)}(n):(Se("You do not have permission to delete this tag.","error"),r.disabled=!0,r.classList.add("opacity-50","cursor-not-allowed"))})),(e.is_deleted||"admin"!==xe.role&&xe.user_id!==e.created_by)&&(r.disabled=!0,r.classList.add("opacity-50","cursor-not-allowed"))}}function at(e){return rt.apply(this,arguments)}function rt(){return(rt=o(n().m((function e(t){var a,r;return n().w((function(e){for(;;)switch(e.n){case 0:if(t.preventDefault(),pe){e.n=1;break}return e.a(2);case 1:if(a=pe.value.trim()){e.n=2;break}return Se("Tag name cannot be empty.","error"),e.a(2);case 2:return e.p=2,e.n=3,Oe("/tags","POST",{name:a});case 3:pe.value="",Se("Tag created!","success"),et(),e.n=5;break;case 4:e.p=4,r=e.v,Se("Error creating tag: ".concat(r.message),"error");case 5:return e.a(2)}}),e,null,[[2,4]])})))).apply(this,arguments)}function ot(){return(ot=o(n().m((function e(t){var a;return n().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Oe("/tags/".concat(t),"DELETE");case 1:Se("Tag deleted!","success"),et(),e.n=3;break;case 2:e.p=2,a=e.v,Se("Error deleting tag: ".concat(a.message),"error");case 3:return e.a(2)}}),e,null,[[0,2]])})))).apply(this,arguments)}function st(e){ne&&(ne.innerHTML="",e.filter((function(e){return!e.is_deleted})).forEach((function(e){var t=document.createElement("option");t.value=e.id,t.textContent=e.name,ne.appendChild(t)})))}function it(e){be&&(be.innerHTML="",e.filter((function(e){return!e.is_deleted})).forEach((function(e){var t=document.createElement("option");t.value=e.id,t.textContent=e.name,be.appendChild(t)})))}function ct(){return dt.apply(this,arguments)}function dt(){return dt=o(n().m((function e(){var t,a,r,o,s,i,c,d=arguments;return n().w((function(e){for(;;)switch(e.n){case 0:return t=d.length>0&&void 0!==d[0]?d[0]:null,a=d.length>1&&void 0!==d[1]?d[1]:"All Projects",r=d.length>2&&void 0!==d[2]?d[2]:{},k&&(k.textContent=a),o=new URLSearchParams,t&&o.append("project_id",t),r.search&&o.append("search",r.search),r.priority&&o.append("priority",r.priority),r.status&&o.append("status",r.status),r.assigned_to&&o.append("assigned_to",r.assigned_to),r.tags&&r.tags.length>0&&o.append("tags",r.tags.join(",")),r.due_date_start&&o.append("due_date_start",r.due_date_start),r.due_date_end&&o.append("due_date_end",r.due_date_end),r.order_by&&o.append("order_by",r.order_by),r.order_direction&&o.append("order_direction",r.order_direction),s="/tasks?".concat(o.toString()),e.p=1,e.n=2,Oe(s);case 2:i=e.v,C&&(C.innerHTML="",0===i.tasks.length?A.classList.remove("hidden"):(A.classList.add("hidden"),i.tasks.forEach((function(e){return ut(e)})))),e.n=4;break;case 3:e.p=3,c=e.v,je?Se("Error fetching tasks: ".concat(c.message),"error"):console.warn("Initial task fetch unauthorized (expected before login): ".concat(c.message));case 4:return e.a(2)}}),e,null,[[1,3]])}))),dt.apply(this,arguments)}function ut(e){if(C){var t=document.createElement("div");t.id="task-".concat(e.id);var a=e.is_deleted?"border-red-700":"border-yellow-500",r=e.is_deleted?"bg-red-100":"bg-white";t.className="".concat(r," p-4 rounded-md shadow-sm flex justify-between items-start border-l-4 ").concat(a);var s=e.tags?e.tags.map((function(t){return'\n        <span class="inline-flex items-center bg-gray-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2">\n            '.concat(t.name,'\n            <button data-task-id="').concat(e.id,'" data-tag-id="').concat(t.id,'" class="remove-tag-btn ml-1 text-gray-500 hover:text-red-700 transition text-xs font-bold">&times;</button>\n        </span>\n    ')})).join(""):"";t.innerHTML='\n        <div class="flex-grow">\n            <h4 class="text-lg font-semibold text-gray-800">'.concat(e.title," ").concat(e.is_deleted?"(Deleted)":"",'</h4>\n            <p class="text-sm text-gray-600 mb-2">').concat(e.description||"No description",'</p>\n            <p class="text-xs text-gray-500 mb-2">\n                Due: ').concat(e.due_date?new Date(e.due_date).toLocaleDateString():"N/A",' |\n                Priority: <span class="font-medium text-').concat(function(e){switch(e){case"urgent":return"red-600";case"high":return"orange-600";case"medium":return"blue-600";case"low":return"green-600";default:return"gray-600"}}(e.priority),'">').concat(e.priority,'</span> |\n                Status: <span class="font-medium text-').concat(function(e){switch(e){case"completed":return"green-600";case"in-progress":return"blue-600";case"blocked":return"red-600";case"pending":return"yellow-600";default:return"gray-600"}}(e.status),'">').concat(e.status,'</span>\n            </p>\n            <p class="text-xs text-gray-500 mb-2">\n                Project: ').concat(e.project_name||"N/A"," | Assigned To: ").concat(e.assigned_to_username||"Unassigned",'\n            </p>\n            <div class="mt-2">').concat(s,'</div>\n        </div>\n        <div class="flex flex-col space-y-2 ml-4">\n            <button data-id="').concat(e.id,'" \n                    data-title="').concat(e.title,'" \n                    data-description="').concat(e.description||"",'"\n                    data-due-date="').concat(e.due_date?new Date(e.due_date).toISOString().split("T")[0]:"",'"\n                    data-priority="').concat(e.priority,'"\n                    data-status="').concat(e.status,'"\n                    data-assigned-to="').concat(e.assigned_to||"",'"\n                    data-project-id="').concat(e.project_id,'"\n                    data-parent-task-id="').concat(e.parent_task_id||"","\"\n                    data-tags='").concat(JSON.stringify(e.tags||[]),'\'\n                    class="edit-task-btn bg-yellow-500 text-white p-2 rounded-md text-sm hover:bg-yellow-600 transition shadow-sm">Edit</button>\n            <button data-id="').concat(e.id,'" class="delete-task-btn bg-red-500 text-white p-2 rounded-md text-sm hover:bg-red-600 transition shadow-sm">Delete</button>\n        </div>\n    '),C.appendChild(t);var i=t.querySelector(".edit-task-btn");i.addEventListener("click",(function(t){var n={id:t.target.dataset.id,title:t.target.dataset.title,description:t.target.dataset.description,due_date:t.target.dataset.dueDate,priority:t.target.dataset.priority,status:t.target.dataset.status,assigned_to:e.assigned_to||"",project_id:e.project_id,parent_task_id:e.parent_task_id||"",tags:JSON.parse(t.target.dataset.tags||"[]")},a=e.created_by,r=e.assigned_to;"admin"===xe.role||xe.user_id===a||xe.user_id===r?function(e){Y&&(R.value=e.id,V.value=e.project_id,re.value=JSON.stringify(e.tags||[]),K.value=e.title,$.value=e.description,Q.value=e.due_date,W.value=e.priority,X.value=e.status,Z.value=e.assigned_to||"",ee.value=e.project_id||"",te.value=e.parent_task_id,ne&&(Array.from(ne.options).forEach((function(e){e.selected=!1})),e.tags.forEach((function(e){var t=ne.querySelector('option[value="'.concat(e.id,'"]'));t&&(t.selected=!0)}))),Y.classList.remove("hidden"))}(n):(Se("You do not have permission to edit this task.","error"),i.disabled=!0,i.classList.add("opacity-50","cursor-not-allowed"))}));var c=t.querySelector(".delete-task-btn");c.addEventListener("click",(function(t){var n=t.target.dataset.id,a=e.created_by;"admin"===xe.role||xe.user_id===a?confirm('Are you sure you want to delete task "'.concat(e.title,'"? This will soft-delete it.'))&&function(e){ht.apply(this,arguments)}(n):(Se("You do not have permission to delete this task.","error"),c.disabled=!0,c.classList.add("opacity-50","cursor-not-allowed"))})),t.querySelectorAll(".remove-tag-btn").forEach((function(t){var a=t;a.addEventListener("click",function(){var t=o(n().m((function t(r){var o,s,i,c;return n().w((function(t){for(;;)switch(t.n){case 0:if(o=r.target.dataset.taskId,s=r.target.dataset.tagId,i=e.created_by,"admin"!==xe.role&&xe.user_id!==i){t.n=5;break}if(!confirm("Are you sure you want to remove this tag from the task?")){t.n=4;break}return t.p=1,t.n=2,Oe("/tasks/".concat(o,"/tags/").concat(s),"DELETE");case 2:Se("Tag removed from task!","success"),ct(Te,k.textContent,bt()),t.n=4;break;case 3:t.p=3,c=t.v,Se("Error removing tag: ".concat(c.message),"error");case 4:t.n=6;break;case 5:Se("You do not have permission to remove tags from this task.","error"),a.disabled=!0,a.classList.add("opacity-50","cursor-not-allowed");case 6:return t.a(2)}}),t,null,[[1,3]])})));return function(e){return t.apply(this,arguments)}}()),(e.is_deleted||"admin"!==xe.role&&xe.user_id!==e.created_by)&&(a.disabled=!0,a.classList.add("opacity-50","cursor-not-allowed"))})),e.is_deleted&&(i.disabled=!0,i.classList.add("opacity-50","cursor-not-allowed"),c.disabled=!0,c.classList.add("opacity-50","cursor-not-allowed"))}}function lt(){Y&&(Y.classList.add("hidden"),z.reset(),ne&&Array.from(ne.options).forEach((function(e){return e.selected=!1})),re.value="")}function pt(e){return mt.apply(this,arguments)}function mt(){return(mt=o(n().m((function t(a){var r,o,s,i,c,d,u,l,p,m,f,g,v,y,h;return n().w((function(t){for(;;)switch(t.n){case 0:return a.preventDefault(),r=R.value,V.value,o={title:K.value,description:$.value,due_date:Q.value||null,priority:W.value,status:X.value,assigned_to:Z.value?parseInt(Z.value):null,project_id:ee.value?parseInt(ee.value):null,parent_task_id:te.value?parseInt(te.value):null},s=Array.from(ne.selectedOptions).map((function(e){return parseInt(e.value)})),t.p=1,t.n=2,vt(r,o);case 2:Se("Task updated successfully!","success"),lt(),i=JSON.parse(re.value||"[]"),c=s.filter((function(e){return!i.some((function(t){return t.id===e}))})),d=i.filter((function(e){return!s.includes(e.id)})).map((function(e){return e.id})),u=e(d),t.p=3,u.s();case 4:if((l=u.n()).done){t.n=6;break}return p=l.value,t.n=5,Oe("/tasks/".concat(r,"/tags/").concat(p),"DELETE");case 5:t.n=4;break;case 6:t.n=8;break;case 7:t.p=7,v=t.v,u.e(v);case 8:return t.p=8,u.f(),t.f(8);case 9:m=e(c),t.p=10,m.s();case 11:if((f=m.n()).done){t.n=13;break}return g=f.value,t.n=12,Oe("/tasks/".concat(r,"/tags/").concat(g),"POST");case 12:t.n=11;break;case 13:t.n=15;break;case 14:t.p=14,y=t.v,m.e(y);case 15:return t.p=15,m.f(),t.f(15);case 16:ct(Te,k.textContent,bt()),t.n=18;break;case 17:t.p=17,h=t.v,Se("Error updating task: ".concat(h.message),"error");case 18:return t.a(2)}}),t,null,[[10,14,15,16],[3,7,8,9],[1,17]])})))).apply(this,arguments)}function ft(e){return gt.apply(this,arguments)}function gt(){return(gt=o(n().m((function t(a){var r,o,s,i,c,d,u,l,p,m,f,g,v,y,h,b;return n().w((function(t){for(;;)switch(t.n){case 0:if(a.preventDefault(),_&&T){t.n=1;break}return t.a(2);case 1:if(r=_.value,o=I.value,s=L.value||null,i=x.value,c=j.value,d=B.value||null,u=T.value,l=S.value||null,p=Array.from(ae.selectedOptions).map((function(e){return parseInt(e.value)})),r&&u){t.n=2;break}return Se("Task title and project must be selected.","error"),t.a(2);case 2:return t.p=2,t.n=3,Oe("/tasks","POST",{title:r,description:o,due_date:s,priority:i,status:c,assigned_to:d?parseInt(d):null,project_id:parseInt(u),parent_task_id:l?parseInt(l):null});case 3:m=t.v,f=m.task.id,g=e(p),t.p=4,g.s();case 5:if((v=g.n()).done){t.n=7;break}return y=v.value,t.n=6,Oe("/tasks/".concat(f,"/tags/").concat(y),"POST");case 6:t.n=5;break;case 7:t.n=9;break;case 8:t.p=8,h=t.v,g.e(h);case 9:return t.p=9,g.f(),t.f(9);case 10:Se("Task created!","success"),w.reset(),Array.from(ae.options).forEach((function(e){return e.selected=!1})),ne&&Array.from(ne.options).forEach((function(e){return e.selected=!1})),ct(Te,k.textContent,bt()),t.n=12;break;case 11:t.p=11,b=t.v,Se("Error creating task: ".concat(b.message),"error");case 12:return t.a(2)}}),t,null,[[4,8,9,10],[2,11]])})))).apply(this,arguments)}function vt(e,t){return yt.apply(this,arguments)}function yt(){return(yt=o(n().m((function e(t,a){var r;return n().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,void 0!==a.assigned_to&&null!==a.assigned_to&&(a.assigned_to=a.assigned_to?parseInt(a.assigned_to):null),e.n=1,Oe("/tasks/".concat(t),"PUT",a);case 1:Se("Task updated!","success"),e.n=3;break;case 2:e.p=2,r=e.v,Se("Error updating task: ".concat(r.message),"error");case 3:return e.a(2)}}),e,null,[[0,2]])})))).apply(this,arguments)}function ht(){return(ht=o(n().m((function e(t){var a;return n().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Oe("/tasks/".concat(t),"DELETE");case 1:Se("Task deleted!","success"),e.n=3;break;case 2:e.p=2,a=e.v,Se("Error deleting task: ".concat(a.message),"error");case 3:return e.a(2)}}),e,null,[[0,2]])})))).apply(this,arguments)}function bt(){return{search:ge.value.trim(),priority:ve.value,status:ye.value,assigned_to:he.value||null,tags:Array.from(be.selectedOptions).map((function(e){return parseInt(e.value)})),due_date_start:we.value||null,due_date_end:_e.value||null,order_by:Ie.value,order_direction:Le.value}}function Et(){var e=bt();ct(Te,k.textContent,e)}function kt(){ge.value="",ve.value="",ye.value="",he.value="",Array.from(be.options).forEach((function(e){return e.selected=!1})),we.value="",_e.value="",Ie.value="created_at",Le.value="DESC",ct(Te,k.textContent)}function wt(){return _t.apply(this,arguments)}function _t(){return(_t=o(n().m((function e(){var t,a;return n().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Oe("/notifications");case 1:r=(t=e.v).notifications,D&&(D.innerHTML="",0!==r.length?(r.forEach((function(e){var t=document.createElement("li");t.className="p-3 mb-2 rounded-md shadow-sm ".concat(e.is_read?"bg-gray-100 text-gray-700":"bg-blue-50 text-blue-800 font-semibold"),t.dataset.notificationId=e.id;var n="";"TASK"===e.entity_type&&e.entity_id?n=' (<a href="#" data-task-id="'.concat(e.entity_id,'" class="notification-task-link text-blue-600 hover:underline">View Task</a>)'):"PROJECT"===e.entity_type&&e.entity_id&&(n=' (<a href="#" data-project-id="'.concat(e.entity_id,'" class="notification-project-link text-blue-600 hover:underline">View Project</a>)')),t.innerHTML="\n            ".concat(e.message," ").concat(n,'\n            <span class="block text-xs text-right ').concat(e.is_read?"text-gray-500":"text-blue-600",'">\n                ').concat(new Date(e.created_at).toLocaleString(),"\n            </span>\n        "),D.appendChild(t)})),D.querySelectorAll(".notification-task-link").forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault();var t=e.target.dataset.taskId;Se("Clicked to view Task ID: ".concat(t),"info")}))})),D.querySelectorAll(".notification-project-link").forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault();var t=e.target.dataset.projectId;Se("Clicked to view Project ID: ".concat(t),"info")}))}))):D.innerHTML='<li class="text-center text-gray-500">No notifications.</li>'),n=t.notifications.filter((function(e){return!e.is_read})).length,N&&(n>0?(N.textContent=n,N.classList.remove("hidden")):N.classList.add("hidden")),e.n=3;break;case 2:e.p=2,a=e.v,Se("Error fetching notifications: ".concat(a.message),"error");case 3:return e.a(2)}var n,r}),e,null,[[0,2]])})))).apply(this,arguments)}function It(){return Lt.apply(this,arguments)}function Lt(){return(Lt=o(n().m((function e(){var t,a;return n().w((function(e){for(;;)switch(e.n){case 0:if(0!==(t=Array.from(D.children).filter((function(e){return!e.classList.contains("bg-gray-100")})).map((function(e){return parseInt(e.dataset.notificationId)}))).length){e.n=1;break}return Se("No unread notifications to clear.","info"),e.a(2);case 1:return e.p=1,e.n=2,Oe("/notifications/mark-read","POST",{notificationIds:t});case 2:Se("Notifications cleared!","success"),wt(),e.n=4;break;case 3:e.p=3,a=e.v,Se("Error clearing notifications: ".concat(a.message),"error");case 4:return e.a(2)}}),e,null,[[1,3]])})))).apply(this,arguments)}function xt(){P&&(P.classList.toggle("hidden"),P.classList.contains("hidden")||wt())}document.addEventListener("DOMContentLoaded",(function(){s=document.getElementById("auth-section"),i=document.getElementById("main-app-section"),c=document.getElementById("welcome-username"),d=document.getElementById("logout-btn"),O=document.getElementById("global-message"),u=document.getElementById("register-form"),l=document.getElementById("login-form"),p=document.getElementById("show-login-btn"),m=document.getElementById("show-register-btn"),f=document.getElementById("register-btn"),g=document.getElementById("login-btn"),v=document.getElementById("auth-message"),H=document.getElementById("register-username"),q=document.getElementById("register-email"),J=document.getElementById("register-password"),G=document.getElementById("login-email"),U=document.getElementById("login-password"),document.getElementById("projects-section"),y=document.getElementById("create-project-form"),h=document.getElementById("project-name"),b=document.getElementById("projects-list"),E=document.getElementById("no-projects-message"),document.getElementById("tasks-section"),k=document.getElementById("current-project-name"),w=document.getElementById("create-task-form"),_=document.getElementById("task-title"),I=document.getElementById("task-description"),L=document.getElementById("task-due-date"),x=document.getElementById("task-priority"),j=document.getElementById("task-status"),B=document.getElementById("task-assigned-to"),T=document.getElementById("task-project-id"),S=document.getElementById("task-parent-task-id"),C=document.getElementById("tasks-list"),A=document.getElementById("no-tasks-message"),ae=document.getElementById("task-tags"),Y=document.getElementById("edit-task-modal"),z=document.getElementById("edit-task-form"),F=document.getElementById("cancel-edit-task-btn"),R=document.getElementById("edit-task-id"),V=document.getElementById("edit-task-original-project-id"),K=document.getElementById("edit-task-title"),$=document.getElementById("edit-task-description"),Q=document.getElementById("edit-task-due-date"),W=document.getElementById("edit-task-priority"),X=document.getElementById("edit-task-status"),Z=document.getElementById("edit-task-assigned-to"),ee=document.getElementById("edit-task-project-id"),te=document.getElementById("edit-task-parent-task-id"),ne=document.getElementById("edit-task-tags"),re=document.getElementById("edit-task-original-tags"),oe=document.getElementById("edit-project-modal"),se=document.getElementById("edit-project-form"),ie=document.getElementById("cancel-edit-project-btn"),ce=document.getElementById("edit-project-id"),de=document.getElementById("edit-project-name"),ue=document.getElementById("edit-project-description"),document.getElementById("tags-section"),le=document.getElementById("create-tag-form"),pe=document.getElementById("tag-name"),me=document.getElementById("tags-list"),fe=document.getElementById("no-tags-message"),ge=document.getElementById("task-filter-search"),ve=document.getElementById("task-filter-priority"),ye=document.getElementById("task-filter-status"),he=document.getElementById("task-filter-assigned-to"),be=document.getElementById("task-filter-tags"),Ee=document.getElementById("apply-filters-btn"),ke=document.getElementById("clear-filters-btn"),we=document.getElementById("task-filter-due-date-start"),_e=document.getElementById("task-filter-due-date-end"),Ie=document.getElementById("task-filter-order-by"),Le=document.getElementById("task-filter-order-direction"),P=document.getElementById("notifications-container"),D=document.getElementById("notifications-list"),N=document.getElementById("notifications-badge"),M=document.getElementById("clear-notifications-btn");var e=document.getElementById("toggle-notifications-btn");p.addEventListener("click",(function(){return Ae(!0)})),m.addEventListener("click",(function(){return Ae(!1)})),f.addEventListener("click",De),g.addEventListener("click",Me),d.addEventListener("click",qe),y.addEventListener("submit",Re),w.addEventListener("submit",ft),z.addEventListener("submit",pt),F.addEventListener("click",lt),Y.addEventListener("click",(function(e){e.target===Y&&lt()})),se.addEventListener("submit",ze),ie.addEventListener("click",Ye),oe.addEventListener("click",(function(e){e.target===oe&&Ye()})),le&&le.addEventListener("submit",at),Ee&&Ee.addEventListener("click",Et),ke&&ke.addEventListener("click",kt),ge&&ge.addEventListener("input",Et),ve&&ve.addEventListener("change",Et),ye&&ye.addEventListener("change",Et),he&&he.addEventListener("change",Et),be&&be.addEventListener("change",Et),we&&we.addEventListener("change",Et),_e&&_e.addEventListener("change",Et),Ie&&Ie.addEventListener("change",Et),Le&&Le.addEventListener("change",Et),e&&e.addEventListener("click",xt),M&&M.addEventListener("click",It),je=localStorage.getItem("jwt_token"),xe=JSON.parse(localStorage.getItem("current_user")),Je(),je||console.warn("Not logged in. Initial task fetch will be unauthorized (expected).")}))})();